{ config, lib, pkgs, ... }:

let
  thinkpadt580 = "00ffffffffffff0009e5d70600000000011a0104a523137802a260a45750a025145054000000010101010101010101010101010101014dd000a0f0703e803020350059c21000001a000000000000000000000000000000000000000000fe00424f452048460a202020202020000000fe004e5631353651554d2d4e34340a00dd";
  dellu39 = "00ffffffffffff0010ac25a14c313630291c0104b54627783eee95a3544c99260f5054a54b00714f8180a9c0a940d1c0e100d10001014dd000a0f0703e8030203500b9882100001a000000ff004639574e5750320a2020202020000000fc0044454c4c205533323139510a20000000fd0031560a8936010a202020202020018802031df150101f200514041312110302161507060123091f0783010000565e00a0a0a0295030203500b9882100001aa36600a0f0701f8030203500b9882100001a4d6c80a070703e8030203a00b9882100001a023a801871382d40582c4500b9882100001ebf1600a08038134030203a00b9882100001a0000000000000000fa";
  dellu2414h-1 = "00ffffffffffff0010aca4a04c5638361a19010380351e78ee7e75a755529c270f5054a54b00714f8180a9c0a940d1c0010101010101023a801871382d40582c45000f282100001e000000ff00523946315035364e3638564c0a000000fc0044454c4c205532343134480a20000000fd00384c1e5311000a202020202020014b02031ff14c9005040302071601141f12132309070765030c00100083010000023a801871382d40582c45000f282100001e011d8018711c1620582c25000f282100009e011d007251d01e206e2855000f282100001e8c0ad08a20e02d10103e96000f282100001800000000000000000000000000000000000000000000000037";
in
{
  services.autorandr.enable = true;

  my.home = { config, pkgs, ... }: {
    programs.autorandr = {
      enable = true;

      hooks.postswitch."notify-i3" = "${config.xsession.windowManager.i3.package}/bin/i3-msg restart";

      profiles = {
        home = {
          fingerprint = {
            internal = thinkpadt580;
            primary = dellu39;
            secondary = dellu2414h-1;
          };
          config = {
            internal.enable = false;
            primary = {
              enable = true;
              primary = true;
              crtc = 0;
              position = "1080x0";
              mode = "3840x2160";
              rate = "60.00";
            };
            secondary = {
              enable = true;
              crtc = 2;
              position = "0x0";
              mode = "1920x1080";
              rate = "60.00";
              rotate = "left";
            };
          };
        };
      };
    };
  };
}
